<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-slider/paper-slider.html">

<dom-module id="bouns-app">
  <template>
    <style>
       :host {
        display: block;
        max-width: 600px;
        margin: auto;
      }

      paper-slider.red {
        --paper-slider-knob-color: var(--paper-red-900);
        --paper-slider-active-color: var(--paper-red-500);
        width: 100%;
        --paper-slider-input: {
          width: 60px
        }
        ;
      }

      #salary-container {
        max-width: 700px;
        width: 100%;
        margin: 0 auto;
      }
    </style>

    <h2>Bereken je salaris</h2>
    <div id="salary-container">

      <paper-input value="{{klantUurTarief}}" always-float-label label="Uur tarief van de klant" auto-validate pattern="[0-9]*"
        error-message="numbers only!" type="string" maxlength="3">
        <div slot="prefix">€</div>
      </paper-input>

      <div>Basic Salary</div>
      <paper-slider class="red" value='{{selectedBasicSalary}}' min='2000' max='6000' pin snaps max-markers="40" step="100" editable>
      </paper-slider>
      <div>Aantal uren</div>
      <paper-slider class="red" value='{{selectedHours}}' min='0' max='166' editable></paper-slider>

      <paper-input label="Interne tarief" readonly value='[[interneTarief]]'>
        <div slot="prefix">€</div>
      </paper-input>
      <paper-input label="Bouns" readonly value="{{bouns}}">
        <div slot="prefix">€</div>
      </paper-input>

      <paper-input label="Bruto salaris" readonly value="[[brutoSalary]]">
        <div slot="prefix">€</div>
      </paper-input>
    </div>

  </template>

  <script>
    /**
     * @customElement
     * @polymer
     */
    class BounsApp extends Polymer.Element {

      constructor() {
        super();
        this.res_interneTarief;
        this.res_bruto;
      }

      static get is() {
        return 'bouns-app';
      }

      static get properties() {
        return {
          klantUurTarief: {
            type: String,
            value: 0
          },
          selectedBasicSalary: {
            type: Number,
            value: 2500,
            observer: 'getInterneTarief'
          },
          selectedHours: {
            type: Number,
            value: 144
          },
          interneTarief: {
            type: Number,
            computed: 'getInterneTarief(selectedBasicSalary)'
          },
          bouns: {
            type: Number,
            computed: 'getBouns(klantUurTarief, res_interneTarief, selectedHours)'
          },
          brutoSalary: {
            type: Number,
            computed: 'getBrutoSalary(klantUurTarief, selectedBasicSalary, selectedHours)'
          },
        }
      }

      getInterneTarief(selectedBasicSalary) {
        let basisSalaris = [2000, 2100, 2200, 2300, 2400, 2500, 2600, 2700, 2800, 2900, 3000, 3100, 3200, 3300,
          3400, 3500, 3600, 3700, 3800, 3900, 4000, 4100, 4200, 4300, 4400, 4500, 4600, 4700, 4800, 4900, 5000,
          5100, 5200, 5300, 5400, 5500, 5600, 5700, 5800, 5900, 6000
        ];
        let tarief = [46, 47.5, 49, 50.5, 52, 53, 54.5, 56, 57.5, 59, 60, 61, 62.5, 64, 65.5, 67, 68, 69.5,
          71, 72.5, 74, 75, 76.5, 78, 79.5, 81, 82.5, 84, 90, 91.5, 93, 94.5, 96, 97.5, 99, 100.5, 102,
          103.5, 105, 106.5, 108
        ];
        for (var i = 0; i < basisSalaris.length; i++) {
          if (this.selectedBasicSalary == basisSalaris[i]) {
            this.res_interneTarief = tarief[i];
          }
        }
        return this.res_interneTarief;
      }

      getBouns(klantUurTarief, res_interneTarief, selectedHours) {
        this.res_bouns = ((klantUurTarief - res_interneTarief) * 0.7) * selectedHours;
        if (this.res_bouns >= 0) {
          return this.res_bouns;
        }
      }

      getBrutoSalary() {
        this.res_bruto = this.res_bouns + this.selectedBasicSalary;
        if (this.res_bruto >= 0) {
          return this.res_bruto;
        }
      }
    }

    window.customElements.define(BounsApp.is, BounsApp);
  </script>
</dom-module>