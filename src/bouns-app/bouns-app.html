<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/app-layout/app-layout.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-slider/paper-slider.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">

<dom-module id="bouns-app">
  <template>
    <style>
       :host {
        display: block;
        font-family: Roboto, Noto, sans-serif;
      }

      app-toolbar {
        background-color: var(--paper-red-900);
        color: white;
        margin: 20px 0;
      }

      paper-slider.red {
        --paper-slider-knob-color: var(--paper-red-900);
        --paper-slider-active-color: var(--paper-red-500);
        width: 100%;
        --paper-slider-input: {
          width: 60px
        }
        ;
      }

      paper-button.reset {
        background: var(--paper-red-900);
        width: 100%;
      }

      paper-button.reset:hover {
        background: var(--paper-blue-900);
      }

      #salary-container {
        max-width: 700px;
        width: 90%;
        margin: 0 auto;
      }
    </style>

    <div id="salary-container">
      </br>
      <app-header>
        <app-toolbar>
          <div main-title>Bereken je Salaris</div>
        </app-toolbar>
      </app-header>
      <paper-input value="{{clientHourlyRate}}" always-float-label label="Uurtarief van de klant" auto-validate pattern="[0-9]*"
        error-message="Alleen getallen!" type="string" maxlength="3">
        <div slot="prefix">€</div>
      </paper-input>
      </br>
      </br>
      <div>Basissalaris</div>
      <paper-slider class="red" value='{{selectedBasicSalary}}' min='2000' max='6000' pin snaps max-markers="40" step="100" editable>
      </paper-slider>
      <div>Aantal Uren</div>
      <paper-slider class="red" value='{{selectedHours}}' min='0' max='166' editable></paper-slider>
      </br>
      <paper-input label="Interne Uurtarief" readonly value='[[InternalRate]]'>
        <div slot="prefix">€</div>
      </paper-input>
      <paper-input label="Bouns" readonly value="[[bouns]]">
        <div slot="prefix">€</div>
      </paper-input>
      <paper-input label="Bruto Salaris" readonly value="[[grossSalary]]">
        <div slot="prefix">€</div>
      </paper-input>
      </br>
      </br>
      <paper-button class="reset" on-click="_reset" role="button">
        <iron-icon icon="check"></iron-icon>
        Reset
      </paper-button>
      </br>
    </div>
  </template>

  <script>
    /**
     * @customElement
     * @polymer
     */
    class BounsApp extends Polymer.Element {

      static get is() {
        return 'bouns-app';
      }

      static get properties() {
        return {
          clientHourlyRate: {
            type: String
          },
          selectedBasicSalary: {
            type: Number,
            value: 2500,
            observer: 'getInternalRate'
          },
          selectedHours: {
            type: Number,
            value: 144
          },
          InternalRate: {
            type: Number,
            computed: 'getInternalRate(selectedBasicSalary)'
          },
          bouns: {
            type: Number,
            computed: 'getBouns(clientHourlyRate, InternalRate, selectedHours)'
          },
          grossSalary: {
            type: Number,
            computed: 'getGrossSalary(bouns, selectedBasicSalary)'
          },
        }
      }

      getInternalRate(selectedBasicSalary) {
        let res_InternalRate;
        let basisSalaris = [2000, 2100, 2200, 2300, 2400, 2500, 2600, 2700, 2800, 2900, 3000, 3100, 3200, 3300,
          3400, 3500, 3600, 3700, 3800, 3900, 4000, 4100, 4200, 4300, 4400, 4500, 4600, 4700, 4800, 4900, 5000,
          5100, 5200, 5300, 5400, 5500, 5600, 5700, 5800, 5900, 6000
        ];
        let tarief = [46, 47.5, 49, 50.5, 52, 53, 54.5, 56, 57.5, 59, 60, 61, 62.5, 64, 65.5, 67, 68, 69.5,
          71, 72.5, 74, 75, 76.5, 78, 79.5, 81, 82.5, 84, 90, 91.5, 93, 94.5, 96, 97.5, 99, 100.5, 102,
          103.5, 105, 106.5, 108
        ];

        for (var i = 0; i < basisSalaris.length; i++) {
          if (selectedBasicSalary == basisSalaris[i]) {
            res_InternalRate = tarief[i];
          }
        }
        return res_InternalRate;
      }

      getBouns(clientHourlyRate, InternalRate, selectedHours) {
        const res_bouns = ((clientHourlyRate - InternalRate) * 0.7) * selectedHours;
        if (res_bouns >= 0) {
          return res_bouns;
        } else {
          return 0;
        }
      }

      getGrossSalary(bouns, selectedBasicSalary) {
        const res_bruto = bouns + selectedBasicSalary;
        if (res_bruto >= 0) {
          return res_bruto;
        } else {
          return 0;
        }
      }

      _reset() {
        window.location.reload();
      }
    }

    window.customElements.define(BounsApp.is, BounsApp);
  </script>
</dom-module>